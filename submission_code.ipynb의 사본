{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7187,"status":"ok","timestamp":1640680061292,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"},"user_tz":-540},"id":"4bYD9iC4bU2-","outputId":"89656723-a91c-48a9-b343-23d811f398a6"},"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: optuna in /usr/local/lib/python3.7/dist-packages (2.10.0)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from optuna) (21.3)\n","Requirement already satisfied: PyYAML in /usr/local/lib/python3.7/dist-packages (from optuna) (3.13)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from optuna) (1.19.5)\n","Requirement already satisfied: scipy!=1.4.0 in /usr/local/lib/python3.7/dist-packages (from optuna) (1.4.1)\n","Requirement already satisfied: cliff in /usr/local/lib/python3.7/dist-packages (from optuna) (3.10.0)\n","Requirement already satisfied: alembic in /usr/local/lib/python3.7/dist-packages (from optuna) (1.7.5)\n","Requirement already satisfied: sqlalchemy>=1.1.0 in /usr/local/lib/python3.7/dist-packages (from optuna) (1.4.27)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.7/dist-packages (from optuna) (4.62.3)\n","Requirement already satisfied: colorlog in /usr/local/lib/python3.7/dist-packages (from optuna) (6.6.0)\n","Requirement already satisfied: cmaes>=0.8.2 in /usr/local/lib/python3.7/dist-packages (from optuna) (0.8.2)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->optuna) (3.0.6)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from sqlalchemy>=1.1.0->optuna) (4.8.2)\n","Requirement already satisfied: greenlet!=0.4.17 in /usr/local/lib/python3.7/dist-packages (from sqlalchemy>=1.1.0->optuna) (1.1.2)\n","Requirement already satisfied: Mako in /usr/local/lib/python3.7/dist-packages (from alembic->optuna) (1.1.6)\n","Requirement already satisfied: importlib-resources in /usr/local/lib/python3.7/dist-packages (from alembic->optuna) (5.4.0)\n","Requirement already satisfied: cmd2>=1.0.0 in /usr/local/lib/python3.7/dist-packages (from cliff->optuna) (2.3.3)\n","Requirement already satisfied: PrettyTable>=0.7.2 in /usr/local/lib/python3.7/dist-packages (from cliff->optuna) (2.4.0)\n","Requirement already satisfied: stevedore>=2.0.1 in /usr/local/lib/python3.7/dist-packages (from cliff->optuna) (3.5.0)\n","Requirement already satisfied: autopage>=0.4.0 in /usr/local/lib/python3.7/dist-packages (from cliff->optuna) (0.4.0)\n","Requirement already satisfied: pbr!=2.1.0,>=2.0.0 in /usr/local/lib/python3.7/dist-packages (from cliff->optuna) (5.8.0)\n","Requirement already satisfied: attrs>=16.3.0 in /usr/local/lib/python3.7/dist-packages (from cmd2>=1.0.0->cliff->optuna) (21.2.0)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from cmd2>=1.0.0->cliff->optuna) (3.10.0.2)\n","Requirement already satisfied: wcwidth>=0.1.7 in /usr/local/lib/python3.7/dist-packages (from cmd2>=1.0.0->cliff->optuna) (0.2.5)\n","Requirement already satisfied: pyperclip>=1.6 in /usr/local/lib/python3.7/dist-packages (from cmd2>=1.0.0->cliff->optuna) (1.8.2)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->sqlalchemy>=1.1.0->optuna) (3.6.0)\n","Requirement already satisfied: MarkupSafe>=0.9.2 in /usr/local/lib/python3.7/dist-packages (from Mako->alembic->optuna) (2.0.1)\n"]}],"source":["!pip install optuna"]},{"cell_type":"code","execution_count":2,"metadata":{"executionInfo":{"elapsed":1401,"status":"ok","timestamp":1640680062681,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"},"user_tz":-540},"id":"TysEu_7SC4oj"},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","import os\n","import random\n","from sklearn.preprocessing import StandardScaler\n","from sklearn.metrics import f1_score\n","from sklearn.ensemble import RandomForestClassifier\n","from sklearn.model_selection import cross_val_score\n","\n","import optuna\n","from optuna import Trial, visualization\n","from optuna.samplers import TPESampler\n","import warnings\n","warnings.filterwarnings('ignore')"]},{"cell_type":"code","source":["def seed_all(seed: int = 1930):\n","\n","    print(\"Using Seed Number {}\".format(seed))\n","\n","    os.environ[\"PYTHONHASHSEED\"] = str(\n","        seed)  \n","    np.random.seed(seed) \n","    random.seed(\n","        seed)\n","\n","\n","def seed_worker(_worker_id):\n","    np.random.seed(worker_seed)\n","    random.seed(worker_seed)\n","    \n","seed_all(seed=1994)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cD9XJnOCfReg","executionInfo":{"status":"ok","timestamp":1640680062994,"user_tz":-540,"elapsed":6,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"}},"outputId":"128f85dd-2401-4596-f4fe-aed5dd3190c6"},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["Using Seed Number 1994\n"]}]},{"cell_type":"markdown","metadata":{"id":"8L9GcI9lLdws"},"source":["# Data Load"]},{"cell_type":"code","execution_count":4,"metadata":{"executionInfo":{"elapsed":326,"status":"ok","timestamp":1640680074493,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"},"user_tz":-540},"id":"YP3mHGz6C9cz"},"outputs":[],"source":["train_loc = './drive/MyDrive/Dacon/heart_disease/data/raw_data/train.csv'\n","test_loc = './drive/MyDrive/Dacon/heart_disease/data/raw_data/test.csv'\n","\n","raw_train = pd.read_csv(train_loc).drop(['id'], axis=1)\n","raw_test = pd.read_csv(test_loc).drop(['id'], axis=1)"]},{"cell_type":"code","source":["raw_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":423},"id":"pF1VsRCnBqIr","executionInfo":{"status":"ok","timestamp":1640680076184,"user_tz":-540,"elapsed":469,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"}},"outputId":"b24c08bb-37d5-4897-9c53-2eb05625459e"},"execution_count":5,"outputs":[{"output_type":"execute_result","data":{"text/html":["\n","  <div id=\"df-1e58f5ac-6dba-4947-bf7b-b9700ecd3726\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>age</th>\n","      <th>sex</th>\n","      <th>cp</th>\n","      <th>trestbps</th>\n","      <th>chol</th>\n","      <th>fbs</th>\n","      <th>restecg</th>\n","      <th>thalach</th>\n","      <th>exang</th>\n","      <th>oldpeak</th>\n","      <th>slope</th>\n","      <th>ca</th>\n","      <th>thal</th>\n","      <th>target</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>53</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>130</td>\n","      <td>197</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>152</td>\n","      <td>0</td>\n","      <td>1.2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>52</td>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>152</td>\n","      <td>298</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>178</td>\n","      <td>0</td>\n","      <td>1.2</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>3</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>54</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>192</td>\n","      <td>283</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>195</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>45</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>138</td>\n","      <td>236</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>152</td>\n","      <td>1</td>\n","      <td>0.2</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>35</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>122</td>\n","      <td>192</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>174</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>146</th>\n","      <td>50</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>140</td>\n","      <td>233</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>163</td>\n","      <td>0</td>\n","      <td>0.6</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>147</th>\n","      <td>51</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>94</td>\n","      <td>227</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>154</td>\n","      <td>1</td>\n","      <td>0.0</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>148</th>\n","      <td>69</td>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>160</td>\n","      <td>234</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>131</td>\n","      <td>0</td>\n","      <td>0.1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>149</th>\n","      <td>46</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>120</td>\n","      <td>249</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>144</td>\n","      <td>0</td>\n","      <td>0.8</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>3</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>150</th>\n","      <td>63</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>140</td>\n","      <td>195</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>179</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>151 rows × 14 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-1e58f5ac-6dba-4947-bf7b-b9700ecd3726')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-1e58f5ac-6dba-4947-bf7b-b9700ecd3726 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-1e58f5ac-6dba-4947-bf7b-b9700ecd3726');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["     age  sex  cp  trestbps  chol  fbs  ...  exang  oldpeak  slope  ca  thal  target\n","0     53    1   2       130   197    1  ...      0      1.2      0   0     2       1\n","1     52    1   3       152   298    1  ...      0      1.2      1   0     3       1\n","2     54    1   1       192   283    0  ...      0      0.0      2   1     3       0\n","3     45    0   0       138   236    0  ...      1      0.2      1   0     2       1\n","4     35    1   1       122   192    0  ...      0      0.0      2   0     2       1\n","..   ...  ...  ..       ...   ...  ...  ...    ...      ...    ...  ..   ...     ...\n","146   50    1   2       140   233    0  ...      0      0.6      1   1     3       0\n","147   51    1   2        94   227    0  ...      1      0.0      2   1     3       1\n","148   69    1   3       160   234    1  ...      0      0.1      1   1     2       1\n","149   46    1   0       120   249    0  ...      0      0.8      2   0     3       0\n","150   63    0   1       140   195    0  ...      0      0.0      2   2     2       1\n","\n","[151 rows x 14 columns]"]},"metadata":{},"execution_count":5}]},{"cell_type":"code","source":["raw_test"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":423},"id":"ohk-SWkrZIEr","executionInfo":{"status":"ok","timestamp":1640680077265,"user_tz":-540,"elapsed":13,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"}},"outputId":"2eb6c530-4b76-4f1f-8b7a-f129bced6d11"},"execution_count":6,"outputs":[{"output_type":"execute_result","data":{"text/html":["\n","  <div id=\"df-128ee3bf-4fce-4b58-a0b6-0aca31ea1fe4\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>age</th>\n","      <th>sex</th>\n","      <th>cp</th>\n","      <th>trestbps</th>\n","      <th>chol</th>\n","      <th>fbs</th>\n","      <th>restecg</th>\n","      <th>thalach</th>\n","      <th>exang</th>\n","      <th>oldpeak</th>\n","      <th>slope</th>\n","      <th>ca</th>\n","      <th>thal</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>57</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>150</td>\n","      <td>276</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>112</td>\n","      <td>1</td>\n","      <td>0.6</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>59</td>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>170</td>\n","      <td>288</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>159</td>\n","      <td>0</td>\n","      <td>0.2</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>57</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>150</td>\n","      <td>126</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>173</td>\n","      <td>0</td>\n","      <td>0.2</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>56</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>134</td>\n","      <td>409</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>150</td>\n","      <td>1</td>\n","      <td>1.9</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>71</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>110</td>\n","      <td>265</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>130</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>147</th>\n","      <td>64</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>130</td>\n","      <td>303</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>122</td>\n","      <td>0</td>\n","      <td>2.0</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>148</th>\n","      <td>43</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>132</td>\n","      <td>341</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>136</td>\n","      <td>1</td>\n","      <td>3.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>149</th>\n","      <td>53</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>123</td>\n","      <td>282</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>95</td>\n","      <td>1</td>\n","      <td>2.0</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>150</th>\n","      <td>67</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>152</td>\n","      <td>277</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>172</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>151</th>\n","      <td>43</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>122</td>\n","      <td>213</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>165</td>\n","      <td>0</td>\n","      <td>0.2</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>2</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>152 rows × 13 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-128ee3bf-4fce-4b58-a0b6-0aca31ea1fe4')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-128ee3bf-4fce-4b58-a0b6-0aca31ea1fe4 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-128ee3bf-4fce-4b58-a0b6-0aca31ea1fe4');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["     age  sex  cp  trestbps  chol  ...  exang  oldpeak  slope  ca  thal\n","0     57    1   0       150   276  ...      1      0.6      1   1     1\n","1     59    1   3       170   288  ...      0      0.2      1   0     3\n","2     57    1   2       150   126  ...      0      0.2      2   1     3\n","3     56    0   0       134   409  ...      1      1.9      1   2     3\n","4     71    0   2       110   265  ...      0      0.0      2   1     2\n","..   ...  ...  ..       ...   ...  ...    ...      ...    ...  ..   ...\n","147   64    0   0       130   303  ...      0      2.0      1   2     2\n","148   43    0   0       132   341  ...      1      3.0      1   0     3\n","149   53    1   0       123   282  ...      1      2.0      1   2     3\n","150   67    0   2       152   277  ...      0      0.0      2   1     2\n","151   43    0   2       122   213  ...      0      0.2      1   0     2\n","\n","[152 rows x 13 columns]"]},"metadata":{},"execution_count":6}]},{"cell_type":"markdown","source":["# Preprocessing\n","* dummy 변수화\n","* scaling"],"metadata":{"id":"peZzikJdywN4"}},{"cell_type":"code","source":["a = pd.get_dummies(raw_train['cp'], prefix = \"cp\")\n","b = pd.get_dummies(raw_train['thal'], prefix = \"thal\")\n","c = pd.get_dummies(raw_train['slope'], prefix = \"slope\")\n","\n","frames = [raw_train, a, b, c]\n","raw_train = pd.concat(frames, axis = 1)\n","\n","raw_train = raw_train.drop(columns = ['cp', 'thal', 'slope'])\n","raw_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":423},"id":"2NDKtC7Oyv4I","executionInfo":{"status":"ok","timestamp":1640680085536,"user_tz":-540,"elapsed":312,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"}},"outputId":"b1941a54-4f2b-4911-81d0-7772ce294da8"},"execution_count":7,"outputs":[{"output_type":"execute_result","data":{"text/html":["\n","  <div id=\"df-e6c5cc9f-a133-49b7-85f6-38a64c1b57d7\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>age</th>\n","      <th>sex</th>\n","      <th>trestbps</th>\n","      <th>chol</th>\n","      <th>fbs</th>\n","      <th>restecg</th>\n","      <th>thalach</th>\n","      <th>exang</th>\n","      <th>oldpeak</th>\n","      <th>ca</th>\n","      <th>target</th>\n","      <th>cp_0</th>\n","      <th>cp_1</th>\n","      <th>cp_2</th>\n","      <th>cp_3</th>\n","      <th>thal_0</th>\n","      <th>thal_1</th>\n","      <th>thal_2</th>\n","      <th>thal_3</th>\n","      <th>slope_0</th>\n","      <th>slope_1</th>\n","      <th>slope_2</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>53</td>\n","      <td>1</td>\n","      <td>130</td>\n","      <td>197</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>152</td>\n","      <td>0</td>\n","      <td>1.2</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>52</td>\n","      <td>1</td>\n","      <td>152</td>\n","      <td>298</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>178</td>\n","      <td>0</td>\n","      <td>1.2</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>54</td>\n","      <td>1</td>\n","      <td>192</td>\n","      <td>283</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>195</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>45</td>\n","      <td>0</td>\n","      <td>138</td>\n","      <td>236</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>152</td>\n","      <td>1</td>\n","      <td>0.2</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>35</td>\n","      <td>1</td>\n","      <td>122</td>\n","      <td>192</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>174</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>146</th>\n","      <td>50</td>\n","      <td>1</td>\n","      <td>140</td>\n","      <td>233</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>163</td>\n","      <td>0</td>\n","      <td>0.6</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>147</th>\n","      <td>51</td>\n","      <td>1</td>\n","      <td>94</td>\n","      <td>227</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>154</td>\n","      <td>1</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>148</th>\n","      <td>69</td>\n","      <td>1</td>\n","      <td>160</td>\n","      <td>234</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>131</td>\n","      <td>0</td>\n","      <td>0.1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>149</th>\n","      <td>46</td>\n","      <td>1</td>\n","      <td>120</td>\n","      <td>249</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>144</td>\n","      <td>0</td>\n","      <td>0.8</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>150</th>\n","      <td>63</td>\n","      <td>0</td>\n","      <td>140</td>\n","      <td>195</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>179</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>151 rows × 22 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e6c5cc9f-a133-49b7-85f6-38a64c1b57d7')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-e6c5cc9f-a133-49b7-85f6-38a64c1b57d7 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-e6c5cc9f-a133-49b7-85f6-38a64c1b57d7');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["     age  sex  trestbps  chol  fbs  ...  thal_2  thal_3  slope_0  slope_1  slope_2\n","0     53    1       130   197    1  ...       1       0        1        0        0\n","1     52    1       152   298    1  ...       0       1        0        1        0\n","2     54    1       192   283    0  ...       0       1        0        0        1\n","3     45    0       138   236    0  ...       1       0        0        1        0\n","4     35    1       122   192    0  ...       1       0        0        0        1\n","..   ...  ...       ...   ...  ...  ...     ...     ...      ...      ...      ...\n","146   50    1       140   233    0  ...       0       1        0        1        0\n","147   51    1        94   227    0  ...       0       1        0        0        1\n","148   69    1       160   234    1  ...       1       0        0        1        0\n","149   46    1       120   249    0  ...       0       1        0        0        1\n","150   63    0       140   195    0  ...       1       0        0        0        1\n","\n","[151 rows x 22 columns]"]},"metadata":{},"execution_count":7}]},{"cell_type":"code","source":["a = pd.get_dummies(raw_test['cp'], prefix = \"cp\")\n","b = pd.get_dummies(raw_test['thal'], prefix = \"thal\")\n","c = pd.get_dummies(raw_test['slope'], prefix = \"slope\")\n","\n","frames = [raw_test, a, b, c]\n","raw_test = pd.concat(frames, axis = 1)\n","\n","raw_test = raw_test.drop(columns = ['cp', 'thal', 'slope'])\n","raw_test"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":423},"id":"_QZOKJ3oyv1w","executionInfo":{"status":"ok","timestamp":1640680088005,"user_tz":-540,"elapsed":312,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"}},"outputId":"d9e796aa-47e9-4097-e533-dd19c8889831"},"execution_count":8,"outputs":[{"output_type":"execute_result","data":{"text/html":["\n","  <div id=\"df-80a14b68-8955-4742-8a67-ddb1d7408c7c\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>age</th>\n","      <th>sex</th>\n","      <th>trestbps</th>\n","      <th>chol</th>\n","      <th>fbs</th>\n","      <th>restecg</th>\n","      <th>thalach</th>\n","      <th>exang</th>\n","      <th>oldpeak</th>\n","      <th>ca</th>\n","      <th>cp_0</th>\n","      <th>cp_1</th>\n","      <th>cp_2</th>\n","      <th>cp_3</th>\n","      <th>thal_0</th>\n","      <th>thal_1</th>\n","      <th>thal_2</th>\n","      <th>thal_3</th>\n","      <th>slope_0</th>\n","      <th>slope_1</th>\n","      <th>slope_2</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>57</td>\n","      <td>1</td>\n","      <td>150</td>\n","      <td>276</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>112</td>\n","      <td>1</td>\n","      <td>0.6</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>59</td>\n","      <td>1</td>\n","      <td>170</td>\n","      <td>288</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>159</td>\n","      <td>0</td>\n","      <td>0.2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>57</td>\n","      <td>1</td>\n","      <td>150</td>\n","      <td>126</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>173</td>\n","      <td>0</td>\n","      <td>0.2</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>56</td>\n","      <td>0</td>\n","      <td>134</td>\n","      <td>409</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>150</td>\n","      <td>1</td>\n","      <td>1.9</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>71</td>\n","      <td>0</td>\n","      <td>110</td>\n","      <td>265</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>130</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>147</th>\n","      <td>64</td>\n","      <td>0</td>\n","      <td>130</td>\n","      <td>303</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>122</td>\n","      <td>0</td>\n","      <td>2.0</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>148</th>\n","      <td>43</td>\n","      <td>0</td>\n","      <td>132</td>\n","      <td>341</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>136</td>\n","      <td>1</td>\n","      <td>3.0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>149</th>\n","      <td>53</td>\n","      <td>1</td>\n","      <td>123</td>\n","      <td>282</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>95</td>\n","      <td>1</td>\n","      <td>2.0</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>150</th>\n","      <td>67</td>\n","      <td>0</td>\n","      <td>152</td>\n","      <td>277</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>172</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>151</th>\n","      <td>43</td>\n","      <td>0</td>\n","      <td>122</td>\n","      <td>213</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>165</td>\n","      <td>0</td>\n","      <td>0.2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>152 rows × 21 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-80a14b68-8955-4742-8a67-ddb1d7408c7c')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-80a14b68-8955-4742-8a67-ddb1d7408c7c button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-80a14b68-8955-4742-8a67-ddb1d7408c7c');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["     age  sex  trestbps  chol  fbs  ...  thal_2  thal_3  slope_0  slope_1  slope_2\n","0     57    1       150   276    0  ...       0       0        0        1        0\n","1     59    1       170   288    0  ...       0       1        0        1        0\n","2     57    1       150   126    1  ...       0       1        0        0        1\n","3     56    0       134   409    0  ...       0       1        0        1        0\n","4     71    0       110   265    1  ...       1       0        0        0        1\n","..   ...  ...       ...   ...  ...  ...     ...     ...      ...      ...      ...\n","147   64    0       130   303    0  ...       1       0        0        1        0\n","148   43    0       132   341    1  ...       0       1        0        1        0\n","149   53    1       123   282    0  ...       0       1        0        1        0\n","150   67    0       152   277    0  ...       1       0        0        0        1\n","151   43    0       122   213    0  ...       1       0        0        1        0\n","\n","[152 rows x 21 columns]"]},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["numeric_var = ['age', 'trestbps', 'chol', 'thalach', 'oldpeak']\n","cate_var = ['sex', 'fbs', 'restecg', 'exang', 'ca', 'cp_0', 'cp_1', 'cp_2', 'cp_3', 'thal_0', 'thal_1', 'thal_2', 'thal_3', 'slope_0', 'slope_1', 'slope_2']"],"metadata":{"id":"UmI3EXM-yv6d","executionInfo":{"status":"ok","timestamp":1640680093389,"user_tz":-540,"elapsed":308,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"}}},"execution_count":9,"outputs":[]},{"cell_type":"code","source":["scaler = StandardScaler()\n","\n","X_train_scaled = pd.DataFrame(scaler.fit_transform(raw_train[numeric_var]), columns = numeric_var)\n","X_test_scaled = pd.DataFrame(scaler.transform(raw_test[numeric_var]), columns = numeric_var)\n","\n","X_train_final = pd.concat([X_train_scaled.reset_index(drop=True), raw_train.loc[:,cate_var].reset_index(drop=True)], axis=1)\n","X_test_final = pd.concat([X_test_scaled.reset_index(drop=True), raw_test.loc[:,cate_var].reset_index(drop=True)], axis=1)"],"metadata":{"id":"M_SJ_fadyvye","executionInfo":{"status":"ok","timestamp":1640680139013,"user_tz":-540,"elapsed":312,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"}}},"execution_count":12,"outputs":[]},{"cell_type":"code","source":["X_train_final"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":423},"id":"cSN8w1ryC7cR","executionInfo":{"status":"ok","timestamp":1640680143874,"user_tz":-540,"elapsed":311,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"}},"outputId":"f86d24cb-30ad-452f-b635-1c3399254392"},"execution_count":13,"outputs":[{"output_type":"execute_result","data":{"text/html":["\n","  <div id=\"df-c73317c0-8257-4098-a531-282f25cbef56\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>age</th>\n","      <th>trestbps</th>\n","      <th>chol</th>\n","      <th>thalach</th>\n","      <th>oldpeak</th>\n","      <th>sex</th>\n","      <th>fbs</th>\n","      <th>restecg</th>\n","      <th>exang</th>\n","      <th>ca</th>\n","      <th>cp_0</th>\n","      <th>cp_1</th>\n","      <th>cp_2</th>\n","      <th>cp_3</th>\n","      <th>thal_0</th>\n","      <th>thal_1</th>\n","      <th>thal_2</th>\n","      <th>thal_3</th>\n","      <th>slope_0</th>\n","      <th>slope_1</th>\n","      <th>slope_2</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>-0.168640</td>\n","      <td>-0.113897</td>\n","      <td>-0.846549</td>\n","      <td>0.058612</td>\n","      <td>0.206190</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>-0.281315</td>\n","      <td>1.118560</td>\n","      <td>0.952353</td>\n","      <td>1.170264</td>\n","      <td>0.206190</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>-0.055965</td>\n","      <td>3.359390</td>\n","      <td>0.685189</td>\n","      <td>1.897112</td>\n","      <td>-0.902462</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>-1.070043</td>\n","      <td>0.334270</td>\n","      <td>-0.151924</td>\n","      <td>0.058612</td>\n","      <td>-0.717686</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>-2.196797</td>\n","      <td>-0.562063</td>\n","      <td>-0.935604</td>\n","      <td>0.999240</td>\n","      <td>-0.902462</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>146</th>\n","      <td>-0.506666</td>\n","      <td>0.446311</td>\n","      <td>-0.205356</td>\n","      <td>0.528926</td>\n","      <td>-0.348136</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>147</th>\n","      <td>-0.393991</td>\n","      <td>-2.130644</td>\n","      <td>-0.312222</td>\n","      <td>0.144124</td>\n","      <td>-0.902462</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>148</th>\n","      <td>1.634166</td>\n","      <td>1.566726</td>\n","      <td>-0.187545</td>\n","      <td>-0.839260</td>\n","      <td>-0.810074</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>149</th>\n","      <td>-0.957368</td>\n","      <td>-0.674104</td>\n","      <td>0.079618</td>\n","      <td>-0.283434</td>\n","      <td>-0.163361</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>150</th>\n","      <td>0.958114</td>\n","      <td>0.446311</td>\n","      <td>-0.882171</td>\n","      <td>1.213019</td>\n","      <td>-0.902462</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>151 rows × 21 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c73317c0-8257-4098-a531-282f25cbef56')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c73317c0-8257-4098-a531-282f25cbef56 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c73317c0-8257-4098-a531-282f25cbef56');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["          age  trestbps      chol   thalach  ...  thal_3  slope_0  slope_1  slope_2\n","0   -0.168640 -0.113897 -0.846549  0.058612  ...       0        1        0        0\n","1   -0.281315  1.118560  0.952353  1.170264  ...       1        0        1        0\n","2   -0.055965  3.359390  0.685189  1.897112  ...       1        0        0        1\n","3   -1.070043  0.334270 -0.151924  0.058612  ...       0        0        1        0\n","4   -2.196797 -0.562063 -0.935604  0.999240  ...       0        0        0        1\n","..        ...       ...       ...       ...  ...     ...      ...      ...      ...\n","146 -0.506666  0.446311 -0.205356  0.528926  ...       1        0        1        0\n","147 -0.393991 -2.130644 -0.312222  0.144124  ...       1        0        0        1\n","148  1.634166  1.566726 -0.187545 -0.839260  ...       0        0        1        0\n","149 -0.957368 -0.674104  0.079618 -0.283434  ...       1        0        0        1\n","150  0.958114  0.446311 -0.882171  1.213019  ...       0        0        0        1\n","\n","[151 rows x 21 columns]"]},"metadata":{},"execution_count":13}]},{"cell_type":"code","source":["X_test_final"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":423},"id":"oMZ1q8soFQFg","executionInfo":{"status":"ok","timestamp":1640680144315,"user_tz":-540,"elapsed":8,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"}},"outputId":"8869d6f5-c636-4c52-b8c7-85c8e93c933d"},"execution_count":14,"outputs":[{"output_type":"execute_result","data":{"text/html":["\n","  <div id=\"df-357cb775-0294-4da7-ae4f-820686f54ef1\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>age</th>\n","      <th>trestbps</th>\n","      <th>chol</th>\n","      <th>thalach</th>\n","      <th>oldpeak</th>\n","      <th>sex</th>\n","      <th>fbs</th>\n","      <th>restecg</th>\n","      <th>exang</th>\n","      <th>ca</th>\n","      <th>cp_0</th>\n","      <th>cp_1</th>\n","      <th>cp_2</th>\n","      <th>cp_3</th>\n","      <th>thal_0</th>\n","      <th>thal_1</th>\n","      <th>thal_2</th>\n","      <th>thal_3</th>\n","      <th>slope_0</th>\n","      <th>slope_1</th>\n","      <th>slope_2</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0.282062</td>\n","      <td>1.006519</td>\n","      <td>0.560513</td>\n","      <td>-1.651620</td>\n","      <td>-0.348136</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0.507412</td>\n","      <td>2.126934</td>\n","      <td>0.774244</td>\n","      <td>0.357903</td>\n","      <td>-0.717686</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0.282062</td>\n","      <td>1.006519</td>\n","      <td>-2.111124</td>\n","      <td>0.956484</td>\n","      <td>-0.717686</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0.169386</td>\n","      <td>0.110187</td>\n","      <td>2.929364</td>\n","      <td>-0.026899</td>\n","      <td>0.852903</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1.859517</td>\n","      <td>-1.234312</td>\n","      <td>0.364593</td>\n","      <td>-0.882016</td>\n","      <td>-0.902462</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>147</th>\n","      <td>1.070789</td>\n","      <td>-0.113897</td>\n","      <td>1.041407</td>\n","      <td>-1.224062</td>\n","      <td>0.945290</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>148</th>\n","      <td>-1.295394</td>\n","      <td>-0.001855</td>\n","      <td>1.718222</td>\n","      <td>-0.625481</td>\n","      <td>1.869166</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>149</th>\n","      <td>-0.168640</td>\n","      <td>-0.506042</td>\n","      <td>0.667378</td>\n","      <td>-2.378469</td>\n","      <td>0.945290</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>150</th>\n","      <td>1.408816</td>\n","      <td>1.118560</td>\n","      <td>0.578324</td>\n","      <td>0.913729</td>\n","      <td>-0.902462</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>151</th>\n","      <td>-1.295394</td>\n","      <td>-0.562063</td>\n","      <td>-0.561574</td>\n","      <td>0.614438</td>\n","      <td>-0.717686</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>152 rows × 21 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-357cb775-0294-4da7-ae4f-820686f54ef1')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-357cb775-0294-4da7-ae4f-820686f54ef1 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-357cb775-0294-4da7-ae4f-820686f54ef1');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["          age  trestbps      chol   thalach  ...  thal_3  slope_0  slope_1  slope_2\n","0    0.282062  1.006519  0.560513 -1.651620  ...       0        0        1        0\n","1    0.507412  2.126934  0.774244  0.357903  ...       1        0        1        0\n","2    0.282062  1.006519 -2.111124  0.956484  ...       1        0        0        1\n","3    0.169386  0.110187  2.929364 -0.026899  ...       1        0        1        0\n","4    1.859517 -1.234312  0.364593 -0.882016  ...       0        0        0        1\n","..        ...       ...       ...       ...  ...     ...      ...      ...      ...\n","147  1.070789 -0.113897  1.041407 -1.224062  ...       0        0        1        0\n","148 -1.295394 -0.001855  1.718222 -0.625481  ...       1        0        1        0\n","149 -0.168640 -0.506042  0.667378 -2.378469  ...       1        0        1        0\n","150  1.408816  1.118560  0.578324  0.913729  ...       0        0        0        1\n","151 -1.295394 -0.562063 -0.561574  0.614438  ...       0        0        1        0\n","\n","[152 rows x 21 columns]"]},"metadata":{},"execution_count":14}]},{"cell_type":"code","source":["train_X = X_train_final.values\n","train_y = raw_train.loc[:,'target'].values\n","test_X = X_test_final.values"],"metadata":{"id":"nIo_q2mc-Q9X","executionInfo":{"status":"ok","timestamp":1640680162789,"user_tz":-540,"elapsed":307,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"}}},"execution_count":15,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"ZnJa_7zdMWD6"},"source":["# Optuna"]},{"cell_type":"code","execution_count":16,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"FnqPnUXfbtkd","outputId":"814246eb-0ee3-4180-c4e8-32601127fa63","executionInfo":{"status":"ok","timestamp":1640680213545,"user_tz":-540,"elapsed":46453,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"}}},"outputs":[{"output_type":"stream","name":"stderr","text":["\u001b[32m[I 2021-12-28 08:29:27,658]\u001b[0m A new study created in memory with name: no-name-96d8116d-8f1d-481a-974e-0066df1549e4\u001b[0m\n","\u001b[32m[I 2021-12-28 08:29:34,612]\u001b[0m Trial 0 finished with value: 0.8217456165843263 and parameters: {'max_depth': 9, 'max_leaf_nodes': 532, 'n_estimators': 414}. Best is trial 0 with value: 0.8217456165843263.\u001b[0m\n","\u001b[32m[I 2021-12-28 08:29:38,277]\u001b[0m Trial 1 finished with value: 0.8615636615636616 and parameters: {'max_depth': 1, 'max_leaf_nodes': 555, 'n_estimators': 168}. Best is trial 1 with value: 0.8615636615636616.\u001b[0m\n","\u001b[32m[I 2021-12-28 08:29:42,789]\u001b[0m Trial 2 finished with value: 0.8055294003681099 and parameters: {'max_depth': 9, 'max_leaf_nodes': 150, 'n_estimators': 353}. Best is trial 1 with value: 0.8615636615636616.\u001b[0m\n","\u001b[32m[I 2021-12-28 08:29:46,407]\u001b[0m Trial 3 finished with value: 0.8372856727695437 and parameters: {'max_depth': 9, 'max_leaf_nodes': 431, 'n_estimators': 267}. Best is trial 1 with value: 0.8615636615636616.\u001b[0m\n","\u001b[32m[I 2021-12-28 08:29:49,612]\u001b[0m Trial 4 finished with value: 0.8411209366048075 and parameters: {'max_depth': 7, 'max_leaf_nodes': 638, 'n_estimators': 203}. Best is trial 1 with value: 0.8615636615636616.\u001b[0m\n","\u001b[32m[I 2021-12-28 08:29:54,922]\u001b[0m Trial 5 finished with value: 0.842146662791824 and parameters: {'max_depth': 4, 'max_leaf_nodes': 17, 'n_estimators': 276}. Best is trial 1 with value: 0.8615636615636616.\u001b[0m\n","\u001b[32m[I 2021-12-28 08:30:00,381]\u001b[0m Trial 6 finished with value: 0.8572962362436046 and parameters: {'max_depth': 1, 'max_leaf_nodes': 278, 'n_estimators': 434}. Best is trial 1 with value: 0.8615636615636616.\u001b[0m\n","\u001b[32m[I 2021-12-28 08:30:03,538]\u001b[0m Trial 7 finished with value: 0.8442434369853725 and parameters: {'max_depth': 3, 'max_leaf_nodes': 530, 'n_estimators': 176}. Best is trial 1 with value: 0.8615636615636616.\u001b[0m\n","\u001b[32m[I 2021-12-28 08:30:07,802]\u001b[0m Trial 8 finished with value: 0.8493485420904776 and parameters: {'max_depth': 3, 'max_leaf_nodes': 946, 'n_estimators': 278}. Best is trial 1 with value: 0.8615636615636616.\u001b[0m\n","\u001b[32m[I 2021-12-28 08:30:13,726]\u001b[0m Trial 9 finished with value: 0.8572962362436046 and parameters: {'max_depth': 1, 'max_leaf_nodes': 275, 'n_estimators': 460}. Best is trial 1 with value: 0.8615636615636616.\u001b[0m\n"]}],"source":["def RF_objective(trial):\n","    max_depth = trial.suggest_int('max_depth', 1, 10)\n","    max_leaf_nodes = trial.suggest_int('max_leaf_nodes', 2, 1000)\n","    n_estimators =  trial.suggest_int('n_estimators', 100, 500)\n","   \n","    model = RandomForestClassifier(max_depth = max_depth, max_leaf_nodes = max_leaf_nodes,n_estimators = n_estimators,n_jobs=2,random_state=25)\n","\n","    \n","    model.fit(train_X, train_y)    \n","    score = cross_val_score(model, train_X, train_y, cv=5, scoring=\"f1\")\n","    f1_mean = score.mean()\n","\n","    return f1_mean\n","    \n","#Execute optuna and set hyperparameters\n","RF_study = optuna.create_study(direction='maximize')\n","RF_study.optimize(RF_objective, n_trials=10)\n","\n","#Create an instance with tuned hyperparameters\n","optimized_RF = RandomForestClassifier(max_depth = RF_study.best_params['max_depth'], max_leaf_nodes = RF_study.best_params['max_leaf_nodes'],\n","                                      n_estimators = RF_study.best_params['n_estimators'],n_jobs=2,random_state=25)"]},{"cell_type":"markdown","source":["* 위 코드는 간소화를 위해 10번의 trials만 돌렸으나, 실제로는 1000~5000번의 trial을 통해 도출된 hyper-parameter는 다음과 같습니다."],"metadata":{"id":"XMcpnpzyKOen"}},{"cell_type":"code","source":["optimized_RF = RandomForestClassifier(n_estimators=474, max_depth=1, max_leaf_nodes=552, random_state=25)"],"metadata":{"id":"88sIGfEhgkmi","executionInfo":{"status":"ok","timestamp":1640680233011,"user_tz":-540,"elapsed":356,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"}}},"execution_count":17,"outputs":[]},{"cell_type":"code","source":["optimized_RF.fit(train_X,train_y)"],"metadata":{"id":"2msvFAFTgpZX","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1640680237062,"user_tz":-540,"elapsed":808,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"}},"outputId":"4dbb342d-7ae6-4481-dc0b-f57648a6c945"},"execution_count":18,"outputs":[{"output_type":"execute_result","data":{"text/plain":["RandomForestClassifier(max_depth=1, max_leaf_nodes=552, n_estimators=474,\n","                       random_state=25)"]},"metadata":{},"execution_count":18}]},{"cell_type":"code","source":["model = RandomForestClassifier(random_state=25, n_estimators=474, max_depth=1, max_leaf_nodes=552)\n","model.fit(train_X, train_y)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"YJuLZxqfwNtD","executionInfo":{"status":"ok","timestamp":1640680246137,"user_tz":-540,"elapsed":755,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"}},"outputId":"8993eaeb-9fca-46f1-9113-25fd145a9d18"},"execution_count":19,"outputs":[{"output_type":"execute_result","data":{"text/plain":["RandomForestClassifier(max_depth=1, max_leaf_nodes=552, n_estimators=474,\n","                       random_state=25)"]},"metadata":{},"execution_count":19}]},{"cell_type":"code","source":["train_preds = optimized_RF.predict(train_X)\n","f1 = f1_score(train_preds,train_y)\n","f1"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"WQeYRUgYkzYG","executionInfo":{"status":"ok","timestamp":1640680248710,"user_tz":-540,"elapsed":377,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"}},"outputId":"2a428ea0-7a1d-4b02-a48f-2cd5abac699c"},"execution_count":20,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.8636363636363636"]},"metadata":{},"execution_count":20}]},{"cell_type":"code","source":["submission_preds = optimized_RF.predict(test_X)"],"metadata":{"id":"eTNtTqoBkWJh","executionInfo":{"status":"ok","timestamp":1640680252254,"user_tz":-540,"elapsed":310,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"}}},"execution_count":21,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"Gj00gWNlPY-2"},"source":["# Prediction"]},{"cell_type":"code","execution_count":22,"metadata":{"id":"4DZjcRenQe-8","executionInfo":{"status":"ok","timestamp":1640680266796,"user_tz":-540,"elapsed":317,"user":{"displayName":"김성우","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09699747628091584373"}}},"outputs":[],"source":["submission = pd.read_csv('./drive/MyDrive/Dacon/heart_disease/data/sample_submission.csv')\n","submission['target'] = submission_preds\n","submission.to_csv('./drive/MyDrive/Dacon/heart_disease/data/RF_tuning_1.csv', index=False)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"unSn9lsyQ5qC"},"outputs":[],"source":[""]}],"metadata":{"colab":{"collapsed_sections":[],"name":"submission_code.ipynb","provenance":[],"mount_file_id":"1mTVI-hcKqp1OXxeeTUT433gsbokbqI9z","authorship_tag":"ABX9TyPNmjIfy5+ss67HJByv3Qvx"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}